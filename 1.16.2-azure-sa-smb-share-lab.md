
## ðŸ”¹ Lab Exercise: Azure Storage Account with SMB File Share and Linux VM Access

### 1. Create a Resource Group

1. Go to **Azure Portal** â†’ **Resource groups** â†’ **+ Create**.
2. Resource group name: `studentname-rg`
3. Region: Choose same region for all resources.
4. Click **Review + Create** â†’ **Create**.

---

### 2. Create a Virtual Network and Subnet

1. Go to **Virtual networks** â†’ **+ Create**.
2. Name: `studentname-vnet`
3. Address space: `10.1.0.0/16`
4. Add a subnet:

   * Name: `studentname-subnet`
   * Subnet address range: `10.1.0.0/24`
5. Associate with `studentname-rg`.
6. Create.

---

### 3. Create a Storage Account

1. Go to **Storage accounts** â†’ **+ Create**.
2. Name: `studentnamestorage` (must be globally unique).
3. Region: same as VNet.
4. Performance: **Standard**
5. Redundancy: **Locally-redundant (LRS)**
6. Under **Networking**:

   * Select **Private endpoint** (to secure access) OR allow from all networks (for lab simplicity, choose **All networks**).
7. Create.

---

### 4. Create an SMB File Share

1. Inside the storage account â†’ **File shares** â†’ **+ File share**.
2. Name: `studentname-share`.
3. Quota: 5 GB.
4. Click **Create**.

---

### 5. Create a Linux VM

1. Go to **Virtual Machines** â†’ **+ Create**.
2. Resource group: `studentname-rg`
3. VM Name: `studentname-vm`
4. Image: **Ubuntu Server 22.04 LTS** (or any supported Linux).
5. Size: Standard B1s (for lab).
6. Authentication: SSH key or password.
7. Networking:

   * Select **studentname-vnet**
   * Subnet: `studentname-subnet`
   * Public IP: Enabled.
8. Create.

---

### 6. Mount the SMB Share on Linux VM

1. Connect to VM via SSH:

   ```bash
   ssh azureuser@<public-ip>
   ```
2. Install CIFS utilities:

   ```bash
   sudo apt-get update
   sudo apt-get install cifs-utils -y
   ```
3. Create mount directory:

   ```bash
   sudo mkdir -p /mnt/studentname-share
   ```
4. Mount SMB share (replace with your storage account and key):

   ```bash
   sudo mount -t cifs //<storageaccountname>.file.core.windows.net/studentname-share /mnt/studentname-share \
   -o vers=3.0,username=<storageaccountname>,password=<storageaccountkey>,dir_mode=0777,file_mode=0777,serverino
   ```

   ðŸ‘‰ Get **storage account key**:

   * Go to **Storage account** â†’ **Security + networking** â†’ **Access keys** â†’ Copy **Key1**.

---

### 7. Make Mount Permanent

1. Edit `fstab`:

   ```bash
   sudo nano /etc/fstab
   ```
2. Add entry:

   ```
   //<storageaccountname>.file.core.windows.net/studentname-share /mnt/studentname-share cifs vers=3.0,username=<storageaccountname>,password=<storageaccountkey>,dir_mode=0777,file_mode=0777,serverino 0 0
   ```
3. Save and exit.
4. Test with:

   ```bash
   sudo mount -a
   ```

---

### 8. Create Files Inside SMB Mount Point

```bash
cd /mnt/studentname-share
echo "Hello from SMB Share" | sudo tee file1.txt
echo "Lab exercise success!" | sudo tee file2.txt
ls -l
```

Files `file1.txt` and `file2.txt` should now be visible in the **Azure Portal â†’ File shares â†’ studentname-share**.

---

âœ… **End Result**:

* Resource Group: `studentname-rg`
* VNet/Subnet: `studentname-vnet`, `studentname-subnet`
* Storage Account: `studentnamestorage`
* SMB File Share: `studentname-share`
* Linux VM: `studentname-vm`
* SMB share mounted and permanent in `/mnt/studentname-share`
* Test files created.

---
