
# üîπ Lab Exercise: Azure Standard Load Balancer with 2 VMs (httpd) ‚Äì Azure Portal (GUI)

### üìù Objective

Deploy a **Standard Load Balancer** that distributes traffic to **two VMs** running Apache HTTPD.

---

## **1. Create Resource Group**

1. Go to **Azure Portal ‚Üí Resource Groups ‚Üí + Create**.
2. Enter:

   * Resource Group: `<studentname-rg>`
   * Region: East US (or your preferred region)
3. Click **Review + Create ‚Üí Create**.

---

## **2. Create a Virtual Network**

1. Go to **Virtual networks ‚Üí + Create**.
2. Enter:

   * Name: `<studentname-vnet>`
   * RG: `<studentname-rg>`
   * Address space: `10.0.0.0/16`
   * Subnet: Name `<studentname-subnet>`, `10.0.1.0/24`
3. Click **Review + Create ‚Üí Create**.

---

## **3. Create a Public IP for Load Balancer**

1. Go to **Public IP addresses ‚Üí + Create**.
2. Enter:

   * Name: `<studentname-pip>`
   * RG: `<studentname-rg>`
   * SKU: **Standard**
   * Assignment: **Static**
3. Click **Review + Create ‚Üí Create**.

---

## **4. Create the Load Balancer**

1. Go to **Load balancers ‚Üí + Create**.
2. Enter:

   * Name: `<studentname-lb>`
   * RG: `<studentname-rg>`
   * SKU: **Standard**
   * Type: **Public**
   * Public IP: Select `<studentname-pip>`
3. Click **Review + Create ‚Üí Create**.

---

## **5. Configure Backend Pool**

1. Open `<studentname-lb>` ‚Üí **Backend pools ‚Üí + Add**.
2. Name: `<studentname-bepool>`
3. Associate to VNet: `<studentname-vnet>`
4. Leave **No targets** for now (we will add VMs later).
5. Click **Add**.

---

## **6. Configure Health Probe**

1. Go to **Load balancer ‚Üí Probes ‚Üí + Add**.
2. Name: `<studentname-hprobe>`
3. Protocol: **TCP**
4. Port: **80**
5. Interval: 5 seconds
6. Unhealthy threshold: 2
7. Click **Add**.

---

## **7. Configure Load Balancing Rule**

1. Go to **Load balancer ‚Üí Load balancing rules ‚Üí + Add**.
2. Name: `<studentname-lbrule>`
3. Frontend IP: `<studentname-frontend>` (default frontend created)
4. Backend pool: `<studentname-bepool>`
5. Protocol: **TCP**
6. Port: **80 ‚Üí 80**
7. Probe: `<studentname-hprobe>`
8. Click **Add**.

---

## **8. Create Two VMs**

1. Go to **Virtual machines ‚Üí + Create ‚Üí Azure Virtual Machine**.

   * VM1: `<studentname-vm1>`
   * VM2: `<studentname-vm2>`
   * Resource group: `<studentname-rg>`
   * Image: **Ubuntu Server 22.04 LTS**
   * Size: Standard\_B1s (for lab)
   * Authentication: SSH or Password
   * Networking: Select **<studentname-vnet> / <studentname-subnet>**
   * Public IP: **None** (so only accessible via Load Balancer)
2. Repeat for second VM.

---

## **9. Install Apache HTTPD on Both VMs**

1. Go to **VMs ‚Üí `<studentname-vm1>` ‚Üí Connect (SSH)**.

   * Run:

     ```bash
     sudo apt update -y
     sudo apt install apache2 -y
     echo "Hello from <studentname-vm1>" | sudo tee /var/www/html/index.html
     ```
2. Repeat for `<studentname-vm2>` with message:

   ```bash
   echo "Hello from <studentname-vm2>" | sudo tee /var/www/html/index.html
   ```

---

## **10. Add VMs to Load Balancer Backend Pool**

1. Open `<studentname-lb>` ‚Üí **Backend pools ‚Üí Edit `<studentname-bepool>`**.
2. Select **Add virtual machine**.
3. Choose:

   * Virtual network: `<studentname-vnet>`
   * VMs: `<studentname-vm1>`, `<studentname-vm2>`
4. Save.

---

## **11. Test Load Balancer**

1. Go to **Public IPs ‚Üí `<studentname-pip>` ‚Üí Copy IP Address**.
2. Open browser: `http://<public-ip>`
3. Refresh a few times:

   * Response alternates between:

     * `Hello from <studentname-vm1>`
     * `Hello from <studentname-vm2>`

---

‚úÖ **End of Lab** ‚Üí You now have an **Azure Standard Load Balancer** distributing traffic between two Apache VMs.

